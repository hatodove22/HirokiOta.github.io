# AGENTS.md — 博士課程学生ポートフォリオ V1

このファイルは、エージェント（Codex CLI）と人間の開発者が本リポジトリで作業する際の共通ルールです。

## スコープと優先順位
- スコープ: このファイルが存在するディレクトリ（リポジトリのルート）配下の全ファイルに適用。
- 優先順位: 直接のシステム/開発者/ユーザー指示 > この AGENTS.md > その他のドキュメント。
- 目的: セッションをまたいだ継続性の確保（新しいチャットでも本ファイルの指示に従う）。

## 作業方針
- 変更予定を `docs/TODO.md` と `docs/PLAN.md` に必ず反映する。
- 大きめの決定・論点は `docs/` 配下に簡潔に記録（1〜3行の要点）。
- 変更はスコープ最小・副作用最小。無関係な改修は行わない。
- セキュリティ/認可/言語切替（i18n）に関わる差分は理由・影響範囲をコメントに1行で併記。

## SDD（Spec Driven Codex）の利用
- リポジトリに `spec-driven-codex` を導入済み。仕様起点で開発する。
- 仕様ファイル: `.sdd/description.md`（最上位の1枚仕様）、`.sdd/target-spec.txt`（要件の箇条書き）。
- Codex プロンプト: `sdd-design.md` / `sdd-implement.md` / `sdd-highway.md` / `sdd-steering.md` / `sdd-tasks.md` / `sdd-archive.md`。
- 運用ルール:
  1) まず `.sdd/target-spec.txt` を更新して要件を確定。
  2) `sdd-design.md` → 設計を固め、影響範囲と受入条件を列挙。
  3) 実装時は `sdd-implement.md` を使い、変更点を TODO/PLAN に反映。
  4) 作業後に `sdd-steering.md` でふりかえり、`sdd-archive.md` に記録。
  5) 変更が UI に影響する場合は chrome-devtools MCP で必ず検証（必須）。

## 言語/出力ポリシー
- 内部思考・設計検討は英語ベースで行う（ログや出力に思考過程は含めない）。
- ユーザー向けの最終出力は日本語で記述する（依頼があれば英語/他言語に切替）。

## コーディング規約（要点）
- 言語/ツール: React + TypeScript + Vite。
- ファイル命名: `kebab-case.tsx`（ページ/コンポーネント）、`camelCase.ts`（ユーティリティ）。
- コンポーネント: 関数コンポーネント + Hooks。副作用は `useEffect` で限定。
- 型: 可能な限り `type`/`interface` を明示。`any` は禁止（やむを得ない場合は TODO で置換方針を記載）。
- i18n: 文言は必ず `src/lib/i18n.ts`（もしくは将来的な辞書管理）を介す。直書き禁止。
- UI: 既存の UI ユーティリティ（`src/components/ui/*`）を再利用し、重複実装を避ける。
- データ取得: 現状はモック優先（`src/lib/notion.ts`）。外部 API 化する場合はフェッチ層を分離。
- エラーハンドリング: 画面では `src/components/error-boundary.tsx` で集約。新規ページ追加時は考慮。

## ブラウザ検証（chrome-devtools MCP 必須）
- ブラウザで視覚/挙動に影響が出る変更を完了したら、毎回必ず chrome-devtools MCP を使って E2E 確認を行う（例外なし）。
- 標準手順:
  1) `npm run dev` で開発サーバー起動（既定: `http://localhost:3000/`）。
  2) chrome-devtools MCP で対象画面へ遷移し、以下を確認：
     - 初期ロード成功（白画/無限スピナーなし）。
     - コンソールエラーなし。
     - 変更点が目視できること（UI/文言/ナビゲーション/プレビュー等）。
  3) 該当する主要フロー（フィルタ・言語トグル・プレビュー・保存など）を一往復実行。
- 確認結果は `docs/TODO.md` の該当タスクに 1 行でメモ（例: 「2025-09-28 dev OK/console clean」）。

## Git 運用（非強制の推奨）
- コミットメッセージ: `feat: ...`, `fix: ...`, `docs: ...`, `refactor: ...` を先頭に付与。
- 1コミット1意図。大規模変更は段階化し、TODO/PLAN の対応項目IDを本文に含める。

## 作業の流れ（チェックリスト）
1) 変更前に `docs/TODO.md` を更新（やること/目的/完了条件）。
2) 実装はスコープ最小で着手。周辺ファイルの規約に合わせる。
3) 変更後に `docs/TODO.md` の対象項目を更新（状態/メモ）。
4) 中長期の計画は `docs/PLAN.md` に反映。

## 既知トピック（このリポジトリ固有）
- 編集モード（Edit Mode）と Decap CMS（`public/admin/`）の連携が進行中。プレビュー・言語切替・スキーマ整合が論点。
- 認証/認可フローは `docs/AuthDesign.md` を一次情報とする。
- 編集モードの UI/動作は `docs/EditMode.md` を一次情報とする。

以上の方針に従い、エージェントは新規セッションでも本ファイルを読み、記載の規約/優先順位を尊重して作業してください。
