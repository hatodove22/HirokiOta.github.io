# AGENTS.md — 博士課程学生ポートフォリオ V1

このファイルは、エージェント（Codex CLI）と人間の開発者が本リポジトリで作業する際の共通ルールです。


## 言語/出力ポリシー
- 内部思考・設計検討は英語ベースで行う（ログや出力に思考過程は含めない）。
- ユーザー向けの最終出力は日本語で記述する（依頼があれば英語/他言語に切替）。


## ブラウザ検証（chrome-devtools MCP 必須）
- ブラウザで視覚/挙動に影響が出る変更を完了したら、毎回必ず chrome-devtools MCP を使って E2E 確認を行う（例外なし）。
- 標準手順:
  1) `npm run dev` で開発サーバー起動（既定: `http://localhost:3000/`）。
  2) chrome-devtools MCP で対象画面へ遷移し、以下を確認：
     - 初期ロード成功（白画/無限スピナーなし）。
     - コンソールエラーなし。
     - 変更点が目視できること（UI/文言/ナビゲーション/プレビュー等）。
  3) 該当する主要フロー（フィルタ・言語トグル・プレビュー・保存など）を一往復実行。
- 確認結果は `docs/TODO.md` の該当タスクに 1 行でメモ（例: 「2025-09-28 dev OK/console clean」）。

## Git 運用（非強制の推奨）
- コミットメッセージ: `feat: ...`, `fix: ...`, `docs: ...`, `refactor: ...` を先頭に付与。
- 1コミット1意図。大規模変更は段階化し、TODO/PLAN の対応項目IDを本文に含める。

## 作業の流れ（チェックリスト）
1) 変更前に `docs/TODO.md` を更新（やること/目的/完了条件）。
2) 実装はスコープ最小で着手。周辺ファイルの規約に合わせる。
3) 変更後に `docs/TODO.md` の対象項目を更新（状態/メモ）。
4) 中長期の計画は `docs/PLAN.md` に反映。

## 既知トピック（このリポジトリ固有）
- 編集モード（Edit Mode）と Decap CMS（`public/admin/`）の連携が進行中。プレビュー・言語切替・スキーマ整合が論点。
- 認証/認可フローは `docs/AuthDesign.md` を一次情報とする。
- 編集モードの UI/動作は `docs/EditMode.md` を一次情報とする。

## ⚠️ AI向け重大な注意書き（必須確認事項）

### プロジェクト・論文・ニュース更新時の必須確認

**AIは以下のルールを厳守してください：**

1. **必要な情報がすべて揃うまで更新作業を開始しない**
   - ユーザーが用意すべき情報リスト（`manuals/projects-update.md`、`manuals/papers-update.md`、`manuals/news-update.md` 参照）に記載されている情報が**すべて揃うまで**、更新作業を開始してはいけません。
   - 情報が不足している場合は、必ずユーザーに確認を取ってください。

2. **更新作業開始前の確認手順**
   - 更新作業を開始する前に、必ず以下の手順を実行してください：
     1. 該当するマニュアル（`manuals/projects-update.md`、`manuals/papers-update.md`、`manuals/news-update.md`）の「ユーザーが用意すべき情報リスト」を確認
     2. ユーザーが提供した情報と照らし合わせて、不足している情報がないか確認
     3. 不足している情報がある場合は、**更新作業を開始せず**、ユーザーに不足している情報を明確に伝えて確認を取る
     4. **すべての必要な情報が揃ったことを確認できた場合のみ**、更新作業を開始する

3. **確認を取る際の注意点**
   - 不足している情報を箇条書きで明確に提示してください
   - ユーザーが「とりあえず進めて」などと言っても、必要な情報が不足している場合は、更新作業を開始しないでください
   - 情報が不足している場合は、「以下の情報が不足しているため、更新作業を開始できません。不足している情報を提供いただけますか？」という形で確認を取ってください

4. **情報が不足している場合の対応**
   - 情報が不足している場合は、**決して推測や仮の値で更新作業を進めないでください**
   - 情報が不足している場合は、**ファイルの作成・更新を行わないでください**
   - 情報が不足している場合は、**ユーザーに確認を取るまで待機してください**

**この注意書きは、プロジェクト・論文・ニュースの更新作業を行う際に、必ず最初に確認してください。**

以上の方針に従い、エージェントは新規セッションでも本ファイルを読み、記載の規約/優先順位を尊重して作業してください。
